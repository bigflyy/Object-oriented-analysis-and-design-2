// =============================================================================
// DoubleBufferedPanel.cs — Панель с двойной буферизацией
// =============================================================================
// Стандартная Panel в WinForms мерцает при перерисовке, потому что
// каждый кадр сначала очищается (видно белое мелькание), а потом рисуется.
//
// Двойная буферизация решает эту проблему:
//   1. Рисование происходит в невидимый буфер (в памяти)
//   2. Готовый кадр целиком копируется на экран за один раз
//   3. Пользователь никогда не видит промежуточное состояние
//
// Дополнительно включён стиль ResizeRedraw — при изменении размера окна
// вся панель перерисовывается полностью, а не только новая область.
// Без этого при растягивании окна остаются артефакты от предыдущего кадра.
// =============================================================================

namespace Prototype
{
    /// Панель с двойной буферизацией — предотвращает мерцание при отрисовке
    /// и обеспечивает чистую перерисовку при изменении размера окна.
    /// Используется для панели предпросмотра корабля и панели информации.
    public class DoubleBufferedPanel : Panel
    {
        public DoubleBufferedPanel()
        {
            // Включаем свойство DoubleBuffered (рисование через буфер)
            DoubleBuffered = true;

            // Устанавливаем стили отрисовки:
            SetStyle(
                // AllPaintingInWmPaint — всё рисование обрабатывается в сообщении WM_PAINT
                //   (не стирать фон отдельно — это убирает мерцание)
                ControlStyles.AllPaintingInWmPaint |
                // UserPaint — контрол сам отвечает за отрисовку (не системная отрисовка)
                ControlStyles.UserPaint |
                // OptimizedDoubleBuffer — оптимизированная двойная буферизация
                ControlStyles.OptimizedDoubleBuffer |
                // ResizeRedraw — перерисовывать ПОЛНОСТЬЮ при изменении размера
                //   (без этого при растягивании окна появляются "призрачные" артефакты)
                ControlStyles.ResizeRedraw,
                true);
        }
    }
}
