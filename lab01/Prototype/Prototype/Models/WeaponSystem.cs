// =============================================================================
// WeaponSystem.cs — Система вооружения корабля
// =============================================================================
// Этот файл содержит:
//   1. Перечисление WeaponType — типы оружия (лазер, плазма, ракеты и т.д.)
//   2. Класс WeaponSystem — ССЫЛОЧНЫЙ ТИП, хранящий тип и урон оружия
//
// ВАЖНО для паттерна Прототип:
//   WeaponSystem — это класс (ссылочный тип), а не структура (значимый тип).
//   Это означает, что при простом копировании (=) копируется только ССЫЛКА,
//   а не сам объект. Поэтому Clone() создаёт НОВЫЙ экземпляр WeaponSystem.
//   Это демонстрирует разницу между глубоким и поверхностным копированием.
// =============================================================================

namespace Prototype.Models
{
    /// Перечисление типов оружия.
    /// Каждый тип имеет уникальное визуальное отображение на корабле.
    public enum WeaponType
    {
        LaserCannon,   // Лазерная пушка — двойные красные лучи из носа корабля
        PlasmaTurret,  // Плазменная турель — фиолетовые сферы сверху и снизу корпуса
        MissileRack,   // Ракетная установка — оранжевые треугольники на крыльях
        TorpedoBay,    // Торпедный отсек — бирюзовые овалы над и под корпусом
        IonBeam        // Ионный луч — расширяющийся конус из носа корабля
    }

    /// Система вооружения корабля — ССЫЛОЧНЫЙ ТИП (класс).
    /// Содержит тип оружия и значение урона.
    /// Имеет собственный метод Clone() для глубокого копирования.
    public class WeaponSystem
    {
        public WeaponType Type { get; set; }

        public int Damage { get; set; }

        /// Человекочитаемое название оружия.
        /// Вычисляемое свойство — определяется по значению Type.
        public string Name => Type switch
        {
            WeaponType.LaserCannon => "Laser Cannon",    // Лазерная пушка
            WeaponType.PlasmaTurret => "Plasma Turret",   // Плазменная турель
            WeaponType.MissileRack => "Missile Rack",     // Ракетная установка
            WeaponType.TorpedoBay => "Torpedo Bay",       // Торпедный отсек
            WeaponType.IonBeam => "Ion Beam",              // Ионный луч
            _ => "Unknown"                                 // Неизвестное оружие
        };

        /// Конструктор — создаёт систему вооружения с указанным типом и уроном.
        public WeaponSystem(WeaponType type, int damage)
        {
            Type = type;
            Damage = damage;
        }

        /// Клонирование (глубокая копия) — создаёт НОВЫЙ объект WeaponSystem
        /// с теми же значениями Type и Damage.
        ///
        /// Без этого метода при клонировании корабля оригинал и клон
        /// делили бы ОДНУ И ТУ ЖЕ ссылку на WeaponSystem,
        /// и изменение урона у одного меняло бы урон у другого.
        public WeaponSystem Clone()
        {
            return new WeaponSystem(Type, Damage);
        }

        public override string ToString() => $"{Name} (Dmg:{Damage})";
    }
}
